{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/almog/ReactPro/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/almog/ReactPro/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/almog/ReactPro/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/Users/almog/ReactPro/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useContext,useReducer,useState}from\"react\";import CartGrid from'../structures/CartGrid.js';import axios from\"axios\";// import CSS for Footer and Header:\nimport'../../css/Cart.css';import{Store}from'../../Store.js';import Form from'../structures/Form.js';import Modal from'../structures/Modal.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case\"FETCH_REQUEST\":return _objectSpread(_objectSpread({},state),{},{loading:true});case\"FETCH_SUCCESS\":return _objectSpread(_objectSpread({},state),{},{loading:false,cartItems:action.payload});case\"FETCH_ERROR\":return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});default:return state;}};function Cart(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),topModal=_useState2[0],setTopModal=_useState2[1];var _useReducer=useReducer(reducer,{cartItems:[],loading:false,error:false}),_useReducer2=_slicedToArray(_useReducer,2),loading=_useReducer2[0].loading,dispatch=_useReducer2[1];var _useContext=useContext(Store),cart=_useContext.state.cart,ctxDispatch=_useContext.dispatch;var onSubmit=function onSubmit(e){e.preventDefault();var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$catch,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:\"FETCH_REQUEST\"});_context.next=3;return axios({method:'POST',url:'http://localhost:3001/add-order',data:{orderItems:cart.cartItems,name:e.target[0].value,email:e.target[1].value,address:e.target[2].value,phone:e.target[3].value,total:cart.total.toFixed(2)}}).catch(function(err){dispatch({type:\"FETCH_ERROR\",payload:err});});case 3:_yield$axios$catch=_context.sent;data=_yield$axios$catch.data;dispatch({type:\"FETCH_SUCCESS\",payload:data});case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData().then(function(data){axios({method:'POST',url:'http://localhost:3001/delete-cart'}).then(function(){ctxDispatch({type:\"DELETE_CART\"});clearCart();});});};var clearCart=function clearCart(){axios({method:'POST',url:'http://localhost:3001/delete-cart'}).then(function(){ctxDispatch({type:\"DELETE_CART\"});});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Modal,{toggleModal:setTopModal,topModal:topModal}),/*#__PURE__*/_jsx(CartGrid,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"price container\",children:[\" Total Price : $\",cart.total.toFixed(2),\"  \"]}),cart.cartItems.length!==0?/*#__PURE__*/_jsx(Form,{clearCart:clearCart,handleSubmit:onSubmit,cart:cart,toggleModal:setTopModal}):loading?/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}):'']});}export default Cart;","map":{"version":3,"names":["React","useContext","useReducer","useState","CartGrid","axios","Store","Form","Modal","reducer","state","action","type","loading","cartItems","payload","error","Cart","topModal","setTopModal","dispatch","cart","ctxDispatch","onSubmit","e","preventDefault","fetchData","method","url","data","orderItems","name","target","value","email","address","phone","total","toFixed","catch","err","then","clearCart","length"],"sources":["C:/Users/almog/ReactPro/client/src/components/home/Cart.js"],"sourcesContent":["import React, { useContext, useReducer, useState } from \"react\";\nimport CartGrid from '../structures/CartGrid.js';\nimport axios from \"axios\";\n// import CSS for Footer and Header:\nimport '../../css/Cart.css'\nimport { Store } from '../../Store.js';\nimport Form from '../structures/Form.js';\nimport Modal from '../structures/Modal.js';\n\nconst reducer = (state, action) => {\n    switch (action.type) {\n        case \"FETCH_REQUEST\":\n            return { ...state, loading: true };\n        case \"FETCH_SUCCESS\":\n            return { ...state, loading: false, cartItems: action.payload };\n        case \"FETCH_ERROR\":\n            return { ...state, loading: false, error: action.payload };\n        default:\n            return state;\n    }\n};\n\nfunction Cart() {\n    const [topModal, setTopModal] = useState(false);\n\n    const [{ loading }, dispatch] = useReducer(reducer, {\n        cartItems: [],\n        loading: false,\n        error: false,\n    });\n    const { state: { cart }, dispatch: ctxDispatch } = useContext(Store);\n    const onSubmit = (e) => {\n        e.preventDefault();\n        const fetchData = async () => {\n            dispatch({ type: \"FETCH_REQUEST\" });\n            const { data } = await axios({\n                method: 'POST',\n                url: 'http://localhost:3001/add-order',\n                data: {\n                    orderItems: cart.cartItems,\n                    name: e.target[0].value,\n                    email: e.target[1].value,\n                    address: e.target[2].value,\n                    phone: e.target[3].value,\n                    total: cart.total.toFixed(2)\n                }\n            }).catch((err) => {\n                dispatch({ type: \"FETCH_ERROR\", payload: err });\n            });\n            dispatch({ type: \"FETCH_SUCCESS\", payload: data });\n        };\n        fetchData().then((data) => {\n            axios({\n                method: 'POST',\n                url: 'http://localhost:3001/delete-cart',\n            }).then(() => {\n                ctxDispatch({ type: \"DELETE_CART\" });\n                clearCart();\n            });\n        });\n    }\n    const clearCart = () => {\n        axios({\n            method: 'POST',\n            url: 'http://localhost:3001/delete-cart',\n        }).then(() => {\n            ctxDispatch({ type: \"DELETE_CART\" });\n        });\n    }\n\n    return (\n        <div>\n            <Modal toggleModal={setTopModal} topModal={topModal} />\n            <CartGrid />\n            <div className=\"price container\"> Total Price : ${cart.total.toFixed(2)}  </div>\n            {\n                cart.cartItems.length !== 0\n                    ? <Form clearCart={clearCart} handleSubmit={onSubmit} cart={cart} toggleModal={setTopModal} /> : loading ? <div>Loading...</div>\n                        : ''\n            }\n        </div >\n    );\n}\n\nexport default Cart;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}